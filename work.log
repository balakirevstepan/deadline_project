=== Практическая работа 3 ===
Студент: Балакирев Степан Сергеевич
Группа: ЗКИ24-17Б

================================================================================
1. СОЗДАНИЕ РЕПОЗИТОРИЯ
================================================================================

$ git init
Initialized empty Git repository in /Users/stepan/vpd/z3/deadline_project/.git/

================================================================================
2. ПЕРВЫЙ КОММИТ (main)
================================================================================

$ git add deadline.py && git commit -m "Инициализация проекта"
[main (root-commit) 1283a11] Инициализация проекта
 1 file changed, 3 insertions(+)
 create mode 100644 deadline.py

================================================================================
3. СОЗДАНИЕ ВЕТКИ feature/deadline-score
================================================================================

$ git checkout -b feature/deadline-score
Switched to a new branch 'feature/deadline-score'

================================================================================
4. КОММИТ ФУНКЦИИ deadline_score
================================================================================

$ git add deadline.py && git commit -m "Добавлена функция deadline_score"
[feature/deadline-score 77d8e40] Добавлена функция deadline_score
 1 file changed, 19 insertions(+), 1 deletion(-)

================================================================================
5. СЛИЯНИЕ feature/deadline-score В main
================================================================================

$ git checkout main && git merge feature/deadline-score
Switched to branch 'main'
Updating 1283a11..77d8e40
Fast-forward
 deadline.py | 20 +++++++++++++++++++-
 1 file changed, 19 insertions(+), 1 deletion(-)

================================================================================
6. СОЗДАНИЕ ВЕТКИ feature/late-list
================================================================================

$ git checkout -b feature/late-list
Switched to a new branch 'feature/late-list'

================================================================================
7. КОММИТ ФУНКЦИИ late_list
================================================================================

$ git add deadline.py && git commit -m "Добавлена функция late_list"
[feature/late-list d8f9fc8] Добавлена функция late_list
 1 file changed, 11 insertions(+)

================================================================================
8. СЛИЯНИЕ feature/late-list В main
================================================================================

$ git checkout main && git merge feature/late-list
Switched to branch 'main'
Updating 77d8e40..d8f9fc8
Fast-forward
 deadline.py | 11 +++++++++++
 1 file changed, 11 insertions(+)

================================================================================
9. СОЗДАНИЕ ВЕТКИ feature/interactive-input
================================================================================

$ git checkout -b feature/interactive-input
Switched to a new branch 'feature/interactive-input'

================================================================================
10. КОММИТ ИНТЕРАКТИВНОГО ВВОДА
================================================================================

$ git add deadline.py && git commit -m "Добавлен интерактивный ввод с клавиатуры"
[feature/interactive-input e2bd27f] Добавлен интерактивный ввод с клавиатуры
 1 file changed, 29 insertions(+)

================================================================================
11. СЛИЯНИЕ feature/interactive-input В main
================================================================================

$ git checkout main && git merge feature/interactive-input
Switched to branch 'main'
Updating d8f9fc8..e2bd27f
Fast-forward
 deadline.py | 29 +++++++++++++++++++++++++++++
 1 file changed, 29 insertions(+)

================================================================================
12. ПОДКЛЮЧЕНИЕ К GITHUB
================================================================================

$ gh repo create deadline_project --public --source=. --push
https://github.com/balakirevstepan/deadline_project

$ git push origin feature/deadline-score feature/late-list feature/interactive-input
 * [new branch]      feature/deadline-score -> feature/deadline-score
 * [new branch]      feature/late-list -> feature/late-list
 * [new branch]      feature/interactive-input -> feature/interactive-input

================================================================================
13. ДЕМОНСТРАЦИЯ РАБОТЫ ФУНКЦИЙ
================================================================================

=== Примеры из задания ===

$ python3 -c "from deadline import deadline_score; print(deadline_score('01.09.2020', '02.09.2020'))"
5

$ python3 -c "from deadline import deadline_score; print(deadline_score('03.09.2020', '02.09.2020'))"
4

$ python3 -c "from deadline import deadline_score; print(deadline_score('31.12.2020', '02.09.2020'))"
0

$ python3 -c "from deadline import late_list; print(late_list({'Иванов': '03.09.2020', 'Петров': '01.09.2020'}, '02.09.2020'))"
['Иванов']

=== Дополнительные примеры ===

$ python3 -c "from deadline import deadline_score; print(deadline_score('15.10.2024', '15.10.2024'))"
5

$ python3 -c "from deadline import deadline_score; print(deadline_score('29.10.2024', '15.10.2024'))"
3

$ python3 -c "from deadline import deadline_score; print(deadline_score('05.11.2024', '15.10.2024'))"
2

$ python3 -c "from deadline import late_list; print(late_list({'Сидоров': '20.10.2024', 'Балакирев': '14.10.2024', 'Козлов': '25.10.2024', 'Андреев': '15.10.2024', 'Васильев': '18.10.2024'}, '15.10.2024'))"
['Васильев', 'Козлов', 'Сидоров']

$ python3 -c "from deadline import deadline_score; deadline_score('2024-10-15', '15.10.2024')"
ValueError: Некорректный формат даты: 2024-10-15. Ожидается DD.MM.YYYY

================================================================================
14. ГРАФ КОММИТОВ
================================================================================

$ git log --all --graph --oneline --decorate
* e2bd27f (HEAD -> main, feature/interactive-input) Добавлен интерактивный ввод с клавиатуры
* d8f9fc8 (feature/late-list) Добавлена функция late_list
* 77d8e40 (feature/deadline-score) Добавлена функция deadline_score
* 1283a11 Инициализация проекта

================================================================================
15. СПИСОК ВЕТОК
================================================================================

$ git branch -a
  feature/deadline-score
  feature/interactive-input
  feature/late-list
* main

================================================================================
16. ИТОГОВЫЙ КОД (deadline.py)
================================================================================

from typing import List
from datetime import datetime

def parse_date(date_str: str) -> datetime:
    try:
        return datetime.strptime(date_str, "%d.%m.%Y")
    except ValueError:
        raise ValueError(f"Некорректный формат даты: {date_str}. Ожидается DD.MM.YYYY")

def deadline_score(pass_date: str, deadline_date: str) -> int:
    submission = parse_date(pass_date)
    deadline = parse_date(deadline_date)

    if submission <= deadline:
        return 5

    days_late = (submission - deadline).days
    weeks_late = (days_late + 6) // 7

    score = 5 - weeks_late
    return max(0, score)

def late_list(grades: dict, deadline_date: str) -> List[str]:
    deadline = parse_date(deadline_date)
    late_students = []

    for student, pass_date in grades.items():
        submission = parse_date(pass_date)
        if submission > deadline:
            late_students.append(student)

    return sorted(late_students)


if __name__ == "__main__":
    print("=== Система оценивания работ ===")
    print("1 - Рассчитать баллы за работу")
    print("2 - Список опоздавших студентов")

    choice = input("Выберите режим (1 или 2): ")

    if choice == "1":
        deadline_date = input("Введите дату дедлайна (DD.MM.YYYY): ")
        pass_date = input("Введите дату сдачи (DD.MM.YYYY): ")
        score = deadline_score(pass_date, deadline_date)
        print(f"Оценка: {score} баллов")

    elif choice == "2":
        deadline_date = input("Введите дату дедлайна (DD.MM.YYYY): ")
        n = int(input("Сколько студентов? "))
        grades = {}
        for i in range(n):
            name = input(f"Фамилия студента {i+1}: ")
            date = input(f"Дата сдачи {name} (DD.MM.YYYY): ")
            grades[name] = date

        late = late_list(grades, deadline_date)
        if late:
            print(f"Опоздавшие: {late}")
        else:
            print("Все сдали вовремя!")
